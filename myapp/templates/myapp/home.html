{% extends "base.html" %}

{% block title %}MyApp Home{% endblock %}

{% block content %}
    <h1>Welcome to MyApp</h1>
    <p>This is the home page of MyApp.</p>
    <h1>Available Products</h1>

    <ul>
        {% for product in data %}  {# Use "data" instead of "products" #}
            <li>
                <h2>{{ product.name }}</h2>
                <p><strong>Price:</strong> ${{ product.price }}</p>
                <p>{{ product.description }}</p>
            </li>
        {% empty %}
            <p>No products available.</p>
        {% endfor %}
    </ul>

    <h2>Taqueria Menu</h2>
    <form method="post">
        {% csrf_token %}
        <ul>
            {% for item in menu %}
                <li>
                    <label>
                        <input type="checkbox" name="items" value="{{ item.name }}">
                        {{ item.name }} - ${{ item.price }}
                    </label>
                </li>
            {% endfor %}
        </ul>
        <button type="submit">Calculate Total</button>
    </form>

    {% if total_price > 0 %}
        <h2>Selected Items:</h2>
        {% for item in selected_items %}
    <li>
        {{ item }} - $
        {% for menu_item in menu %}
            {% if menu_item.name == item %}
                {{ menu_item.price }}
            {% endif %}
        {% endfor %}
    </li>
  
{% endfor %}

        <h2>Total: ${{ total_price }}</h2>
    {% endif %}


    <h2>Coke Vending Machine</h2>

    <p><strong>Amount Due:</strong> {{ amount_due }} cents</p>
    <p><strong>Inserted Coins:</strong> {{ inserted_coins|join:", " }}</p>
    <p><strong>Total Inserted:</strong> {{ total_inserted }} cents</p>

    {% if error_message %}
        <p style="color: red;">{{ error_message }}</p>
    {% endif %}

    {% if amount_due > 0 %}
        <form method="post">
            {% csrf_token %}
            <label for="coin">Insert Coin (5, 10, 25):</label>
            <input type="number" name="coin" required>
            <button type="submit">Submit</button>
        </form>
    {% else %}
        <p style="color: green;"><strong>Change Owed:</strong> {{ change_owed }} cents</p>
        <p>Enjoy your Coke! ðŸ¥¤</p>
        <form method="post" action="{% url 'reset_coke' %}">
            {% csrf_token %}
            <button type="submit">Buy Another</button>
        </form>
    {% endif %}
{% endblock %}
